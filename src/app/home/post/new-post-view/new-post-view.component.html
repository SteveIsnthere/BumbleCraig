<mat-dialog-content id="wrapper">
  <main id="main">
  <!--  <mat-slide-toggle [(ngModel)]="articleMode">Article Mode</mat-slide-toggle>-->
  <mat-stepper orientation="vertical" (selectionChange)="selectionChange($event)" *ngIf="articleMode" style="background-color: #2a2a2a;
;">
    <mat-step> <!-- genre selection -->
      <form>
        <ng-template matStepLabel>Style</ng-template>
        <mat-chip-listbox aria-label="Fish selection">
          <mat-chip-option *ngFor="let genre of genres" (click)="selectGenre(genre)"
                           [selected]="genre == genreSelected"
                           color="warn">
            {{ genre }}
          </mat-chip-option>
        </mat-chip-listbox>
        <button color="primary" mat-raised-button matStepperNext style="margin-top: 10px">Next</button>
      </form>
    </mat-step>

    <mat-step label="Title" [stepControl]="firstFormGroup"> <!-- Post name -->
      <form [formGroup]="firstFormGroup">
        <mat-form-field>
          <mat-label>Title</mat-label>
          <textarea matInput [cdkTextareaAutosize]=true formControlName="firstCtrl"
                    autocomplete="off"
                    [value]="title" (input)="changeTitle($event)"></textarea>
        </mat-form-field>
        <div>
          <button mat-button matStepperPrevious>Back</button>
          <button color="primary" mat-flat-button matStepperNext>Next</button>
        </div>
      </form>
    </mat-step>

    <mat-step> <!-- contents -->
      <ng-template matStepLabel>Contents</ng-template>
      <div id="contents">
        <div class="content" *ngFor="let content of contents">
          <div>
            <ng-container *ngIf="content.file_share_id != 0; else textMsg">
              <app-file-share [fileShareID]=content.file_share_id class="file-content"></app-file-share>
            </ng-container>
            <ng-template #textMsg>
              <span class="text-content">{{ content.content }}</span>
            </ng-template>
          </div>
          <div style="flex: 1"></div>
          <div>
            <button mat-mini-fab color="primary" (click)="deleteAttachment(content)">
              <mat-icon>remove</mat-icon>
            </button>
          </div>
        </div>
      </div>
      <mat-progress-bar mode="indeterminate" *ngIf="uploadingFile" style="padding: 20px 0"></mat-progress-bar>

      <mat-divider style="margin: 20px 0" *ngIf="contents.length>0"></mat-divider>

      <div id="action-section" style="display: flex; gap: 10px; justify-content: center; align-items: center;">
        <button id="upload-button" mat-stroked-button color="primary" (click)="fileInput.click()"
                style="border-radius: 100px">
          <mat-icon>upload</mat-icon>
          File
        </button>
        <button mat-stroked-button (click)="openTextEditor()" color="warn" style="border-radius: 100px">
          <mat-icon>edit_note</mat-icon>
          Text
        </button>
      </div>
    </mat-step>

  </mat-stepper>
  <input hidden type="file" #fileInput (change)="uploadFile($event)"/>
  </main>
</mat-dialog-content>

<mat-dialog-actions align="end">
  <button mat-flat-button color="warn" matDialogClose>
    <mat-icon>save</mat-icon>
    Save as draft
  </button>
  <button mat-flat-button (click)="publishPost()" color="primary" *ngIf="currentStep == 3">
    <mat-icon>publish</mat-icon>
    Publish
  </button>

</mat-dialog-actions>
